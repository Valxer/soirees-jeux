<app-event-form (eventCreated)="addEventToList($event)"></app-event-form>

<hr class="separator">

<section class="event-list-container">
  <h2>Prochaines soirées</h2>

  @switch (state()) {
    @case ('loading') {
      <p class="info-message">Chargement des soirées en cours...</p>
    }

    @case ('error') {
      <div class="info-message error">
        <p>Impossible de charger les données. Le serveur est peut-être indisponible.</p>
        <button (click)="loadEvents()">Réessayer</button>
      </div>
    }
    
    @case ('loaded') {
      <div class="card-container">
        @for (event of events(); track event.id) {
          <article class="event-card">
            <h3>{{ event.name }}</h3>
            <p><strong>Date :</strong> {{ event.date | date:'dd/MM/yyyy à HH:mm' }}</p>
            <p><strong>Places :</strong> {{ event.current_players }} / {{ event.max_players }}</p>
            <div class="btn-container">
              <button class="register-btn" (click)="onRegister(event.id)" [disabled]="event.current_players >= event.max_players">
                @if (event.current_players >= event.max_players) { Complet } @else { S'inscrire }
              </button>
              <button class="delete-btn" (click)="onDelete(event.id, event.name)">Supprimer</button>
            </div>
          </article>
        } @empty {
          <p>Aucune soirée de prévue pour le moment.</p>
        }
      </div>
    }
  }
</section>